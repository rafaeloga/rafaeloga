{"version":"NotebookV1","origId":3623476344927744,"name":"06 - Nested Data","language":"sql","commands":[{"version":"CommandV1","origId":3623476344927745,"guid":"382821ad-3700-435a-bc37-327ea8c1f589","subtype":"command","commandType":"auto","position":1.0,"command":"\n%md-sandbox\n\n<div style=\"text-align: center; line-height: 0; padding-top: 9px;\">\n  <img src=\"https://databricks.com/wp-content/uploads/2018/03/db-academy-rgb-1200px.png\" alt=\"Databricks Learning\" style=\"width: 600px\">\n</div>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5baf9b72-f77e-487c-96d3-9705735ac747"},{"version":"CommandV1","origId":3623476344927746,"guid":"3ae93414-af0b-48d4-b3ed-945e1faa7ef0","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n## Create Tables\nRun the cell below to create tables for the questions in this notebook. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"88d09fe3-f07d-4fdc-984e-6d9fdb770c21"},{"version":"CommandV1","origId":3623476344927747,"guid":"7f726881-f6b3-4921-a92f-6b279464c236","subtype":"command","commandType":"auto","position":3.0,"command":"%run ../Utilities/06-CreateTables","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1141ad36-4ac2-4d90-85e0-fc24933fcde3"},{"version":"CommandV1","origId":3623476344927748,"guid":"c4ed7e83-8a9b-426a-b973-fff00582be9d","subtype":"command","commandType":"auto","position":4.0,"command":"%md\n## Question 1: Array and Explode\n### Summary\nGet a distinct list of authors who have contributed blog posts in the \"Company Blog\" category.\n\n### Steps to complete\nWrite a SQL query that achieves the following: \n- Explodes the **`authors`** field to create an **`author`** field that contains only one author per row in table **`databricksBlog`**.\n- Limits records to contain **only** unique authors\n- Filters records where **`categories`** include \"Company Blog\"\n- Store the results in a temporary view named  **`results`**\n\nA properly completed solution should produce a view named **`results`** similar to this sample output:\n\n|              author|        categories|\n|--------------------|----------------|\n|Anthony Joseph      |[\"Announcements\", \"Company Blog\"]| \n|Vida Ha        |[\"Company Blog\", \"Product\"]| \n|Nan Zhu (Chief Architect at Faimdata)    |[\"Company Blog\", \"Product\"]| ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9eb2c7b4-ce78-4626-8493-15a7bb1102fd"},{"version":"CommandV1","origId":3623476344927749,"guid":"66069e71-83a9-43be-a84f-b0959a0023ca","subtype":"command","commandType":"auto","position":5.0,"command":"--TODO  Answer 1\n\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"15a534da-55cf-4659-a531-8c3cd9a77ccc"},{"version":"CommandV1","origId":3623476344927750,"guid":"5632745b-4741-4bcf-ae46-613a365b20ce","subtype":"command","commandType":"auto","position":6.0,"command":"%md-sandbox\n&copy; 2020 Databricks, Inc. All rights reserved.<br/>\nApache, Apache Spark, Spark and the Spark logo are trademarks of the <a href=\"http://www.apache.org/\">Apache Software Foundation</a>.<br/>\n<br/>\n<a href=\"https://databricks.com/privacy-policy\">Privacy Policy</a> | <a href=\"https://databricks.com/terms-of-use\">Terms of Use</a> | <a href=\"http://help.databricks.com/\">Support</a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"527eee7e-3389-4007-ad02-0f73ab4b7328"}],"dashboards":[],"guid":"5ae86b3a-9c2a-4b68-a82e-c7a1d248fa71","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{}}