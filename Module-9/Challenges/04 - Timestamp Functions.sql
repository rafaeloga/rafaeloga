{"version":"NotebookV1","origId":3623476344927760,"name":"04 - Timestamp Functions","language":"sql","commands":[{"version":"CommandV1","origId":3623476344927761,"guid":"c750efa9-fc63-49df-87d0-04dde164646a","subtype":"command","commandType":"auto","position":1.0,"command":"\n%md-sandbox\n\n<div style=\"text-align: center; line-height: 0; padding-top: 9px;\">\n  <img src=\"https://databricks.com/wp-content/uploads/2018/03/db-academy-rgb-1200px.png\" alt=\"Databricks Learning\" style=\"width: 600px\">\n</div>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"79737a5d-3d49-4b26-945e-71d4f2680ad2"},{"version":"CommandV1","origId":3623476344927762,"guid":"278e875f-3233-466f-a64b-4c8060ec4411","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n## Create Tables\nRun the cell below to create tables for the questions in this notebook. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7d891efc-fab5-43c5-ac67-4bda4ce2b010"},{"version":"CommandV1","origId":3623476344927763,"guid":"558c55c1-00d8-4194-82c8-cd25b68c4ee8","subtype":"command","commandType":"auto","position":3.0,"command":"%run ../Utilities/04-CreateTables","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f01c66d0-0f49-47f3-aecd-b6caa8838b49"},{"version":"CommandV1","origId":3623476344927764,"guid":"2747a9e5-cb62-4371-8363-433496a66d0b","subtype":"command","commandType":"auto","position":4.0,"command":"%md-sandbox\n## Question 1: Extract Year and Month\n### Summary\nExtract the year and month from the **`Timestamp`** field in the table **`timetable1`** and store records with only the 12th month into **`q1Results`** table.\n\n### Steps to complete\nWrite a SQL query that achieves the following: \n  * Extracts the **`year`** and **`month`** from the **`Timestamp`** column from the table **`timetable1`**\n    - **`Timestamp`** is an integer representing seconds since midnight on January 1st, 1970 (e.g. 1519344286). You must cast it as a `timestamp` to to extract years and months. \n  * Filters records to include only month 12\n  * Stores the resulting records in a temporary view named **`q1Results`** with the following schema.\n\n| column | type |\n|--------|--------|\n| Date | timestamp |\n| Year | integer |\n| Month | integer |\n\n\nA properly completed solution should produce a DataFrame similar to this sample output:\n\n|               Date|Year|Month|\n|-------------------|----|-----|\n|2010-12-15 21:36:55|2010|   12|\n|2002-12-01 11:17:54|2002|   12|\n|2017-12-13 11:28:03|2017|   12|","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9a8a9962-7967-403f-a589-a8afffef0490"},{"version":"CommandV1","origId":3623476344927765,"guid":"d45ed462-c18d-467e-aa46-4440623afd15","subtype":"command","commandType":"auto","position":5.0,"command":"-- TODO  Answer 1","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"980502d0-7f1e-4a32-9c77-f8f779879962"},{"version":"CommandV1","origId":3623476344927766,"guid":"60f0a036-d0b1-45c8-b3c1-0f1e13150381","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n## Question 2: Extract year, month, and day of year\n### Summary\nExtract the **year**, **month** and **dayofyear**  from the **`Timestamp`** field in the table **`timetable2`** and return records for **only** the 4th month.\n\n### Steps to complete\nWrite a SQL query that achieves the following:\n* Create **`Year`**, **`Month`** and **`DayOfYear`** columns from the **`Timestamp`** column in the **`timetable2`** table\n   - **`Timestamp`** is an integer representing seconds since midnight on January 1st, 1970 (e.g. 1519344286). You must cast it as a `timestamp` to to extract years, months, and day of year. \n* Filter records to include only month 4 \n* Stores the records in a temporary table named  **`q2Results`** with the following schema:\n\n| column    | type      |\n|-----------|-----------|\n| Date      | timestamp |\n| Year      | integer   |\n| Month     | integer   |\n| DayOfYear | integer   |\n<br>\n\n* A properly completed solution should produce a DataFrame similar to this sample output:\n\n|               Date|Year|Month| DayOfYear |\n|-------------------|----|-----|-----------|\n|2002-04-22 06:41:39|2002|    4|      112  |\n|2012-04-01 05:00:06|2012|    4|       92  |\n|2019-04-05 12:38:42|2019|    4|       95  |","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e119f03d-7420-42fd-96d7-7d222f75f383"},{"version":"CommandV1","origId":3623476344927767,"guid":"1fcc76a8-9085-4476-a304-34100415adbb","subtype":"command","commandType":"auto","position":7.0,"command":"-- TODO  Answer 2\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"07a0f9b2-8675-4d3d-9f48-b086b31bd4e1"},{"version":"CommandV1","origId":3623476344927768,"guid":"f3956856-04c6-44f1-b135-59e89f274b4e","subtype":"command","commandType":"auto","position":8.0,"command":"%md-sandbox\n&copy; 2020 Databricks, Inc. All rights reserved.<br/>\nApache, Apache Spark, Spark and the Spark logo are trademarks of the <a href=\"http://www.apache.org/\">Apache Software Foundation</a>.<br/>\n<br/>\n<a href=\"https://databricks.com/privacy-policy\">Privacy Policy</a> | <a href=\"https://databricks.com/terms-of-use\">Terms of Use</a> | <a href=\"http://help.databricks.com/\">Support</a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c022ed89-1899-4a6e-8405-62f086627525"}],"dashboards":[],"guid":"633dc591-d814-4754-98ec-f71db9be730c","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{}}