{"version":"NotebookV1","origId":3623476344927780,"name":"03 - Joins","language":"sql","commands":[{"version":"CommandV1","origId":3623476344927781,"guid":"e6d9d1bf-fe0b-47fa-b860-554430806b71","subtype":"command","commandType":"auto","position":1.0,"command":"\n%md-sandbox\n\n<div style=\"text-align: center; line-height: 0; padding-top: 9px;\">\n  <img src=\"https://databricks.com/wp-content/uploads/2018/03/db-academy-rgb-1200px.png\" alt=\"Databricks Learning\" style=\"width: 600px\">\n</div>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5c2ae6a9-1ad0-4f3e-ab29-f05bfd3cbfd9"},{"version":"CommandV1","origId":3623476344927782,"guid":"141a9872-f7fc-4808-8834-4f755f387a2c","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n## Create Tables\nRun the cell below to create tables for the questions in this notebook. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b2c4e2f6-834a-48b8-858d-06c4a69207b1"},{"version":"CommandV1","origId":3623476344927783,"guid":"3852dd89-9ef7-4f5b-9374-77bbcad6df18","subtype":"command","commandType":"auto","position":3.0,"command":"%run ../Utilities/03-CreateTables","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"31e71e61-5635-4dfc-a705-e3a194941bf9"},{"version":"CommandV1","origId":3623476344927784,"guid":"d8f86e72-beb5-4af1-9848-94fa301303dd","subtype":"command","commandType":"auto","position":4.0,"command":"%md\n## Question 1: Joins\n### Summary \nPerform a join of two tables **`purchases`** and **`prices`**.\n\n### Steps to complete\nWrite a SQL query that acheives the following: \n* Performs an inner join on two tables **`purchases`** and **`prices`** on the column **`itemId`**\n* Includes **only** 3 columns from the **`purchases`** table: **`transactionId`**, **`itemId`**, and **`value`**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d9e774a5-6eb4-4b40-b798-bf4aeaafd98e"},{"version":"CommandV1","origId":3623476344927785,"guid":"8e4d2b7b-b011-45e8-8069-f4f66fa93baa","subtype":"command","commandType":"auto","position":5.0,"command":"--TODO  Answer 1\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ea60f531-36f6-4704-af39-b4d5e14221c2"},{"version":"CommandV1","origId":3623476344927786,"guid":"d98f1f37-7219-4698-93cf-0e882fe9cbe4","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n## Question 2: Combine Tables\n### Summary\nPerform an outer join on two tables **`discounts`** and **`products`** store the results into **`q2Results`** view.\n\n### Steps to complete\nWrite a SQL query that achieves the following: \n* Performs an outer join on table **`discounts`** and **`products`** on the **`itemName`** column\n* Ensures that the joined view only includes **one** **`itemName`** column that comes from the **`products`** table\n\n\nThe final schema and DataFrame should contain the following columns, though not necessarily in this order:\n\n|column |type |\n|---|---|\n|itemName | string|\n|discountId | integer|\n|discountCode | string|\n|price | double|\n|active | boolean|\n|itemId | integer|\n|amount | integer|","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"99acf44a-31cd-4af7-bc48-1cb424a09557"},{"version":"CommandV1","origId":3623476344927787,"guid":"dc7a6967-082a-4316-b370-646ea5755a50","subtype":"command","commandType":"auto","position":7.0,"command":"-- TODO  Answer 2\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3b0b67d0-0f68-4e16-9fcf-6a689709bf68"},{"version":"CommandV1","origId":3623476344927788,"guid":"7eed2b59-9423-4928-94de-2729b3e22415","subtype":"command","commandType":"auto","position":8.0,"command":"%md\n## Question 3: Cross Join Tables\n### Summary\nPerform a cross join on two tables **`stores`** and **`articles`**.\n\n### Steps to complete\n\n* Perform a cross join on two tables **`stores`** and **`articles`**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4c649f7a-f235-4b86-a17b-da2ef50b4ef3"},{"version":"CommandV1","origId":3623476344927789,"guid":"9d58c13a-6102-4c64-97ad-899380678d14","subtype":"command","commandType":"auto","position":9.0,"command":"-- TODO  Answer 3\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3497450d-0286-48f6-a3fa-f3145fe62a70"},{"version":"CommandV1","origId":3623476344927790,"guid":"f4639aa5-2af0-412e-9d04-a0a2d4e8a8f3","subtype":"command","commandType":"auto","position":10.0,"command":"%md-sandbox\n&copy; 2020 Databricks, Inc. All rights reserved.<br/>\nApache, Apache Spark, Spark and the Spark logo are trademarks of the <a href=\"http://www.apache.org/\">Apache Software Foundation</a>.<br/>\n<br/>\n<a href=\"https://databricks.com/privacy-policy\">Privacy Policy</a> | <a href=\"https://databricks.com/terms-of-use\">Terms of Use</a> | <a href=\"http://help.databricks.com/\">Support</a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fcd5832c-cf9f-4cba-a449-fd3c8b13edc2"}],"dashboards":[],"guid":"43c98762-9c68-4834-af68-12500fe0921b","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{}}