{"version":"NotebookV1","origId":3623476344927718,"name":"02 - Manage Query Results","language":"sql","commands":[{"version":"CommandV1","origId":3623476344927719,"guid":"e851fed2-8956-438d-a234-fa27be05da55","subtype":"command","commandType":"auto","position":1.0,"command":"\n%md-sandbox\n\n<div style=\"text-align: center; line-height: 0; padding-top: 9px;\">\n  <img src=\"https://databricks.com/wp-content/uploads/2018/03/db-academy-rgb-1200px.png\" alt=\"Databricks Learning\" style=\"width: 600px\">\n</div>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"043dbbc6-afe0-406e-950b-828b092f17c4"},{"version":"CommandV1","origId":3623476344927720,"guid":"e498c93f-2661-4c37-9d46-4ea3ece278e8","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n## Create Tables\nRun the cell below to create tables for the questions in this notebook. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d2ca8ebe-ba84-48e1-8854-7134c6eb4b54"},{"version":"CommandV1","origId":3623476344927721,"guid":"7a25c3b9-4a5c-4c21-a8a2-a5782079cc3f","subtype":"command","commandType":"auto","position":3.0,"command":"%run ../Utilities/02-CreateTables","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"05e50a79-041c-4c75-a277-4c5f98e2ad73"},{"version":"CommandV1","origId":3623476344927722,"guid":"ac78e617-479a-44d1-adbf-f2b89a78241d","subtype":"command","commandType":"auto","position":4.0,"command":"%md\n\n## Question 1: Dedupe Sort\n### Summary\nDeduplicate and sort data on products that need to be restocked in a grocery store.\n\n### Steps to complete\nWrite a SQL query on the **`products`** table that achieves the following:\n* Removes duplicate rows \n* Sorts rows by the **`aisle`** column in ascending order (with nulls appearing last), and then by **`price`** in ascending order\n* Stores the results into a temporary view named  **`q1Results`**\n   \n   \nA properly completed solution should return both a DataFrame that looks similar to this:\n\n|itemId|amount|aisle|price|\n|---|---|---|---|\n|  9958|    64|    2|    2|\n|  1432|    23|    3|   24|\n|  3242|    14|    5|    5|\n|...|...|...|...|\n|  7064|    34| null|   24|\n|  0244|    7| null|   36|","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b6fa3796-aa9f-4765-830d-2090e9f8f061"},{"version":"CommandV1","origId":3623476344927723,"guid":"f05a4f5f-4bc6-4037-8fbb-20b7ed15d7b1","subtype":"command","commandType":"auto","position":5.0,"command":"-- TODO   Answer 1\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e1e15a7c-bb03-4ca3-b9e9-80274d9935a2"},{"version":"CommandV1","origId":3623476344927724,"guid":"4cbde5c8-3ccf-4120-a9d9-de0c0fef2a15","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n## Question 2: Limit Results \n### Summary\nReturn the top five results for data that matches a set of criteria.\n\n### Steps to complete\nWrite a SQL query on the table **`raceResults`** that achieves the following: \n* Casts **`lastFinish`** column as date and renames to **`raceDate`**\n* Sorts rows by the **`winOdds`** column in descending order\n* Limits the results to the top 5 **`winOdds`**\n* Stores the results into a temporary view named  **`q2Results`**\n   \nA properly completed solution should return a DataFrame that looks similar to this:\n\n|name|winOdds|raceDate|\n|--- |-------|----------|\n| Dolor Incididunt|    .9634252|    2015-07-29| \n| Excepteur Mollit|    .9524401|    2019-08-15| \n| Magna Ad        |    .9420442|    2017-05-12| \n|  Sed In|.9325211| 2014-08-29|\n|  Qui Cupidat| .9242451| 2011-08-23| ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6aeeca89-1323-48de-828a-3bb00f0a3daf"},{"version":"CommandV1","origId":3623476344927725,"guid":"82558953-db89-4dfb-a0a1-f7fad74593d7","subtype":"command","commandType":"auto","position":7.0,"command":"--TODO  Answer 2\n\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1a40a978-93ef-43ab-9d34-6a69141cc977"},{"version":"CommandV1","origId":3623476344927726,"guid":"1e3bf5e8-e32d-4485-9bf3-3d89a6f88232","subtype":"command","commandType":"auto","position":8.0,"command":"%md-sandbox\n&copy; 2020 Databricks, Inc. All rights reserved.<br/>\nApache, Apache Spark, Spark and the Spark logo are trademarks of the <a href=\"http://www.apache.org/\">Apache Software Foundation</a>.<br/>\n<br/>\n<a href=\"https://databricks.com/privacy-policy\">Privacy Policy</a> | <a href=\"https://databricks.com/terms-of-use\">Terms of Use</a> | <a href=\"http://help.databricks.com/\">Support</a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ef10546a-7007-40f4-b0de-26109f36626c"}],"dashboards":[],"guid":"a294c617-9e2d-4192-ac21-abbce01ffb35","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{}}