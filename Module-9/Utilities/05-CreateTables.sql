{"version":"NotebookV1","origId":3623476344927797,"name":"05-CreateTables","language":"sql","commands":[{"version":"CommandV1","origId":3623476344927798,"guid":"a6672ea8-0bbd-4908-b7ec-a40fe2c5b342","subtype":"command","commandType":"auto","position":1.0,"command":"\n%run ./Common","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a7a10c61-69c4-4b71-bc33-ea8da262e751"},{"version":"CommandV1","origId":3623476344927799,"guid":"e14740b2-f0c9-4162-bc55-33e0d0c31070","subtype":"command","commandType":"auto","position":2.0,"command":"%python\n\n# SETUP\n\ndef setup():\n  return createDummyData(\"dcad_58_p\", yesNo=\"TrueFalse\").createOrReplaceTempView(\"revenue1\")\n\nsetup()\n\ndisplayHTML(\"\"\"\nDeclared the following table:\n   <li><span style=\"color:green; font-weight:bold\">revenue1</span></li>\n\"\"\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bf02af68-3833-4ec5-9857-09296ce01a3f"},{"version":"CommandV1","origId":3623476344927800,"guid":"154b4c8b-2033-4e4f-bcc6-7d892fcb45fe","subtype":"command","commandType":"auto","position":3.0,"command":"%python\n\n# SETUP\n\ndef setup():\n  return createDummyData(\"dcad_118_p\", yesNo=\"TrueFalse\").createOrReplaceTempView(\"revenue2\")\n\nsetup()\n\ndisplayHTML(\"\"\"\nDeclared the following table:\n   <li><span style=\"color:green; font-weight:bold\">revenue2</span></li>\n\"\"\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1b92c4a4-35fc-4289-a987-5cb56cc5f9af"},{"version":"CommandV1","origId":3623476344927801,"guid":"a2d0018e-57e2-4b9c-9d91-01eed9e963ba","subtype":"command","commandType":"auto","position":4.0,"command":"%python\n\n# SETUP\n\ndef setup():\n  return createDummyData(\"dcad_211_p\", yesNo=\"TrueFalse\").createOrReplaceTempView(\"revenue3\")\n  \nsetup()\n\ndisplayHTML(\"\"\"\nDeclared the following table:\n   <li><span style=\"color:green; font-weight:bold\">revenue3</span></li>\n\"\"\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f066e3c3-e7aa-4d7f-8650-e08c8c780802"},{"version":"CommandV1","origId":3623476344927802,"guid":"a906760c-5775-416b-8ee8-2fc6947fd56d","subtype":"command","commandType":"auto","position":5.0,"command":"%python\n# SETUP\n\ndef setup():\n  createDummyData(\"dcad_131_p\").createOrReplaceTempView(\"revenue4\")\n\nsetup()\n\ndisplayHTML(\"\"\"\nDeclared the following table:\n   <li><span style=\"color:green; font-weight:bold\">revenue4</span></li>\n\"\"\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"aca56fd7-2572-40bf-b5ad-99c9b636d9fb"},{"version":"CommandV1","origId":3623476344927803,"guid":"0e49b20a-8163-4537-be0f-f02c8c9f28f3","subtype":"command","commandType":"auto","position":6.0,"command":"%python\n# SETUP\n\n# Coding Challenge Setup\n# Always declare here any variables or functions created for the candidate\ndef setup():\n  spark.createDataFrame([\n    (\"0S24A4\", 75, None, 36),\n    (\"14G32J\", 23, 3, 24),\n    (\"3F24Y2\", 14, 5, 5),\n    (None, 17, 14, 3),  \n    (\"6F69N3\", 17, 3, 3),\n    (\"6N9M14\", 5, None, 11),\n    (None, 129, 7, 11),  \n    (\"T70K64\", 34, None, 24),\n    (None, 34, None, 22),\n    (\"S38J67\", 34, 7, 8),\n    (\"E47U52\", 81, 2, 2),\n    (\"011H9L\", 56, 12, 11),\n    (\"94JF79\", 73, 7, 11),  \n    (\"5D747S\", 8, 8, 24),\n    (\"S01F66\", 11, 2, 24),\n    (\"8X3V34\", 23, 3, 8),\n    (\"66S87A\", 34, 2, 2)\n  ], [\"itemId\", \"amount\", \"aisle\", \"price\"]).createOrReplaceTempView(\"products\")\n\nsetup()\n\ndisplayHTML(\"\"\"\nDeclared the following tables:\n  <li><span style=\"color:green; font-weight:bold\">products</span> </li>\n\"\"\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"64ab6931-177f-4f92-a74c-3b9447dffdaf"},{"version":"CommandV1","origId":3623476344927804,"guid":"fc652737-4875-434c-9913-630d3f222c4e","subtype":"command","commandType":"auto","position":7.0,"command":"%python\n# SETUP\n\ndef setup():\n  from pyspark.sql.functions import to_timestamp, to_date\n  from pyspark.sql.functions import col\n  \n  (createDummyData(\"rollup\", name=\"itemName\", UTCTime=\"date\", amount=\"revenue\")\n    .dropna()\n    .filter(col(\"itemName\") != \" \")\n    .withColumn(\"date\", to_date(to_timestamp(\"date\")))\n    .select(\"itemName\", \"date\", \"revenue\")\n    .createOrReplaceTempView(\"sales\")\n  ) \n  \n  \nsetup()\ndisplayHTML(\"\"\"\nDeclared the following table:\n   <li><span style=\"color:green; font-weight:bold\">sales</span></li>\n\"\"\")\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a48c8198-3cda-41a2-bb60-266480738978"}],"dashboards":[],"guid":"b5853100-3fe8-427f-8150-b9343c63d777","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{}}