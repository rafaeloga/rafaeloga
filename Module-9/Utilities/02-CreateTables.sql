{"version":"NotebookV1","origId":3623476344927827,"name":"02-CreateTables","language":"sql","commands":[{"version":"CommandV1","origId":3623476344927828,"guid":"4fdb6973-d992-403a-b0d1-cd69b7923af2","subtype":"command","commandType":"auto","position":1.0,"command":"\n%run ./Common","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5e91d485-664f-4040-b146-ebf6f7c1c365"},{"version":"CommandV1","origId":3623476344927829,"guid":"92765e63-b440-4744-935c-a4080ed2308d","subtype":"command","commandType":"auto","position":2.0,"command":"%python\n\n# SETUP\n\n# Coding Challenge Setup\ndef setup():\n  (spark.createDataFrame([\n    (\"0244\", 75, None, 36),\n    (\"1432\", 23, 3, 24),\n    (\"3242\", 14, 5, 5),\n    (\"6693\", 17, 14, 3),  \n    (\"6693\", 17, 14, 3),\n    (\"6914\", 5, None, 11),\n    (\"7012\", 129, 10, 11),  \n    (\"7064\", 34, None, 24),\n    (\"7064\", 34, None, 24),\n    (\"9382\", 15, 7, 8),\n    (\"9958\", 64, 2, 2)\n  ], [\"itemId\", \"amount\", \"aisle\", \"price\"]).createOrReplaceTempView(\"products\"))\n\nsetup()\n\ndisplayHTML(\"\"\"\nDeclared the following table:\n  <li><span style=\"color:green; font-weight:bold\">products</span></li>\n\"\"\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a5f5df5b-f4a4-49b0-99e6-0c808eba5f1e"},{"version":"CommandV1","origId":3623476344927830,"guid":"8e453aa0-ec66-4977-9ce6-be9072ae05bd","subtype":"command","commandType":"auto","position":3.0,"command":"%python\n# Coding Challenge Setup\nfrom pyspark.sql.functions import to_timestamp\n\ndef setup():\n  from pyspark.sql.types import StringType\n  from pyspark.sql.functions import abs, col\n  \n  return (createDummyData(\"mqr_2\", name=\"name\", yesNo=\"active\", UTCTime=\"lastFinish\", id=\"id\", probability=\"winOdds\")\n                 .withColumn(\"lastFinish\", to_timestamp(\"lastFinish\"))\n                 .drop(\"Percent\", \"index\", \"Amount\")\n                 .createOrReplaceTempView(\"raceResults\"))\n          \n\nsetup()\n\ndisplayHTML(\"\"\"\nDeclared the following table:\n  <li><span style=\"color:green; font-weight:bold\">raceResults</span></li>\n\"\"\")\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6aa06c1c-5435-43b2-b7d8-537560749991"}],"dashboards":[],"guid":"4f5e9977-1a2c-4a02-b852-7f6c3878eea1","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{}}