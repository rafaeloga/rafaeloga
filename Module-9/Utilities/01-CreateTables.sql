{"version":"NotebookV1","origId":3623476344927814,"name":"01-CreateTables","language":"sql","commands":[{"version":"CommandV1","origId":3623476344927815,"guid":"52f31a6b-e2b5-4224-a3e1-aa1ec4a480ab","subtype":"command","commandType":"auto","position":1.0,"command":"\n%run ./Common","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1640a9a0-e484-4a67-9048-1ed849d8a69b"},{"version":"CommandV1","origId":3623476344927816,"guid":"5a37561a-9870-4680-8b5e-857fdae49838","subtype":"command","commandType":"auto","position":2.0,"command":"%python\n\ndef setup():\n  from pyspark.sql.types import StringType\n  from pyspark.sql.functions import abs, col\n  \n  return (createDummyData(\"dcad_63_p\", name=\"retailer\", yesNo=\"active\", UTCTime=\"createdAt\", password=\"code\", amount=\"price\", id=\"discountId\")\n                 .withColumn(\"price\", col(\"price\").cast(StringType()))\n                 .withColumn(\"active\", col(\"active\").cast(StringType()))\n                 .withColumn(\"discountId\", abs(col(\"discountId\")).cast(StringType()))\n                 .withColumn(\"createdAt\", col(\"createdAt\").cast(StringType()))\n                 .drop(\"Percent\", \"Probability\", \"index\")\n                 .createOrReplaceTempView(\"discounts\"))\n          \n\nsetup()\n\ndisplayHTML(\"\"\"\nDeclared the following table:\n  <li><span style=\"color:green; font-weight:bold\">discounts</span></li>\n\"\"\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d29625e2-d046-46fb-a5af-23973b4810dc"},{"version":"CommandV1","origId":3623476344927817,"guid":"ce6448b7-7138-4024-84fc-0bfe5516193a","subtype":"command","commandType":"auto","position":3.0,"command":"%python\n# Coding Challenge Setup\ndef setup() -> DataFrame:\n  from pyspark.sql.types import StringType, IntegerType\n  from pyspark.sql.functions import abs, col\n  \n  return (createDummyData(\"dcad_137_p\", yesNo=\"active\", password=\"code\", amount=\"cents\")\n                 .withColumn(\"active\", col(\"active\").cast(StringType()))\n                 .withColumn(\"cents\", (col(\"cents\") * 100).cast(IntegerType()).cast(StringType()))\n                 .drop(\"id\", \"name\", \"UTCTime\", \"Percent\", \"Probability\", \"index\")).createOrReplaceTempView(\"discounts2\")\n\nsetup()\n\ndisplayHTML(\"\"\"\nDeclared the following table:\n  <li><span style=\"color:green; font-weight:bold\">discounts2</span></li>\n\"\"\")\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"17b5c833-eb48-46eb-8486-56d2515860b9"}],"dashboards":[],"guid":"55e95297-dbf1-4eca-b818-e12ba47bcd86","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{}}