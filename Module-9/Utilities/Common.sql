{"version":"NotebookV1","origId":3623476344927809,"name":"Common","language":"sql","commands":[{"version":"CommandV1","origId":3623476344927810,"guid":"407a0f19-4532-46ca-8cfb-4910d7e1bf18","subtype":"command","commandType":"auto","position":1.0,"command":"\n%run ./DummyDataGenerator","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d8e3dd07-c883-4ad1-b611-4da83b2a7bea"},{"version":"CommandV1","origId":3623476344927811,"guid":"290dcb88-f118-4e78-80f7-d717cdcb05d1","subtype":"command","commandType":"auto","position":2.0,"command":"%python\n# These imports are OK to provide for students\nimport pyspark\nfrom typing import Callable, Any, Iterable, List, Set, Tuple","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0fdc6d31-b0d5-4e47-8f81-95a29f4843f9"},{"version":"CommandV1","origId":3623476344927812,"guid":"ee8eabea-186f-4146-b667-9a540275b872","subtype":"command","commandType":"auto","position":3.0,"command":"%scala\nval tags = com.databricks.logging.AttributionContext.current.tags\n\n// Get the user's name\nval username = tags.getOrElse(com.databricks.logging.BaseTagDefinitions.TAG_USER, java.util.UUID.randomUUID.toString.replace(\"-\", \"\"))\nval userhome = s\"dbfs:/user/$username\"\n\nspark.conf.set(\"com.databricks.training.username\", username)\nspark.conf.set(\"com.databricks.training.userhome\", userhome)\n\ndisplayHTML(\"\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b6ee7aa3-c36d-4e99-a3ef-a4f3135019d1"},{"version":"CommandV1","origId":3623476344927813,"guid":"edcb1bf4-2d37-4b00-8fe1-cd0a615f9a7e","subtype":"command","commandType":"auto","position":4.0,"command":"%python\nfrom pyspark import SparkContext\nfrom pyspark.sql import (SparkSession, DataFrame)\n\n\n\nusername = spark.conf.get(\"com.databricks.training.username\")\nuserhome = spark.conf.get(\"com.databricks.training.userhome\")\n\n# *******************************************\n#  GET QUERY STRING\n# *******************************************\n\n\n\ndef getQueryString(df: DataFrame) -> str:\n  # redirect sys.stdout to a buffer\n  import sys, io\n  stdout = sys.stdout\n  sys.stdout = io.StringIO()\n\n  # call module\n  df.explain(extended=True)\n\n  # get output and restore sys.stdout\n  output = sys.stdout.getvalue()\n  sys.stdout = stdout\n\n  return output\n\nNone\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c675dea3-d422-4713-bf3e-c58e49446a47"}],"dashboards":[],"guid":"553fe6e1-dd51-4abe-9a7e-b64c234fa9cf","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{}}