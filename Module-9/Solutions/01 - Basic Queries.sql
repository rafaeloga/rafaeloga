{"version":"NotebookV1","origId":3623476344927699,"name":"01 - Basic Queries","language":"sql","commands":[{"version":"CommandV1","origId":3623476344927700,"guid":"17d27281-7471-4e23-8235-c8444bdfefe0","subtype":"command","commandType":"auto","position":1.0,"command":"\n%md-sandbox\n\n<div style=\"text-align: center; line-height: 0; padding-top: 9px;\">\n  <img src=\"https://databricks.com/wp-content/uploads/2018/03/db-academy-rgb-1200px.png\" alt=\"Databricks Learning\" style=\"width: 600px\">\n</div>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1a47f979-dc82-4c5c-bfbd-789b7a1dcfb5"},{"version":"CommandV1","origId":3623476344927701,"guid":"8f8a3049-8ae4-4a39-8a27-c815d693a4fc","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n## Create Tables\nRun the cell below to create tables for the questions in this notebook. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f6dbe0ff-09bb-476e-a4e7-23ce426929e4"},{"version":"CommandV1","origId":3623476344927702,"guid":"7f1bbdc3-8b01-41b4-99a0-dc25b67d6cd0","subtype":"command","commandType":"auto","position":3.0,"command":"%run ../Utilities/01-CreateTables","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"71db60f3-30fc-4263-b4df-4a4d272d5a9c"},{"version":"CommandV1","origId":3623476344927703,"guid":"90048091-c6a1-4263-8a96-4ff4182b5a8a","subtype":"command","commandType":"auto","position":4.0,"command":"%md\n## Question 1: Modify a Table\n\n### Summary\nModify the columns in table **`discounts`** to match the provided schema.\n\n### Steps to Complete\nWrite a SQL query that achieves the following:\n* Selects columns **`discountId`**, **`code`**, and **`price`**\n* Converts column **`discountId`** to type **`Long`**\n* Converts column **`price`** to type **`Double`**, multiplies it by 100 and then converts to type **`Integer`**\n* Saves this to a temporary view named **`q1Results`**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a0583e26-07bb-40ef-bf05-88fd8faab712"},{"version":"CommandV1","origId":3623476344927704,"guid":"a18c9372-a809-4165-9842-d1f8402a82f6","subtype":"command","commandType":"auto","position":5.0,"command":"--ANSWER\nCREATE OR REPLACE TEMPORARY VIEW q1Results AS\n  SELECT CAST(discountId as long), code, \n  CAST(CAST(price AS double) * 100 AS int) AS price\n  FROM discounts;\n  \nSELECT * FROM q1Results;","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cf7dda84-98ca-4dbe-89f6-82fb9cad38da"},{"version":"CommandV1","origId":3623476344927705,"guid":"ebc3d66a-de3d-4ff3-bdbf-c8a60a02505c","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n## Question 2: Basic Math and Drop Columns\n\n### Summary\nModify the columns in table **`discounts2`** to match the provided schema.\n\n### Steps to complete\nWrite a SQL query on the table **`discounts2`** that achieves the following:\n* Converts column **`active`** to type **`Boolean`**\n* Creates the column **`price`** by converting the column **`cents`** to type **`Double`** and dividing by 100\n* Drops the **`cents`** column\n* Saves this to a temporary view named **`q2Results`**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"203a435b-f793-4691-a47b-0550ae2b523a"},{"version":"CommandV1","origId":3623476344927706,"guid":"b2a7a7c7-0d82-4a69-b269-ef613cdc352b","subtype":"command","commandType":"auto","position":7.0,"command":"--ANSWER\n\nCREATE OR REPLACE TEMPORARY VIEW q2Results AS\n  SELECT cast(active as boolean), cast(cents as double) / 100 as price\n  FROM discounts2;\n\nSELECT * FROM q2Results\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2dfd4b64-1efe-4754-82af-50b3fb283980"},{"version":"CommandV1","origId":3623476344927707,"guid":"1351b0c1-ae62-46f7-a9b6-8c17c9fc2590","subtype":"command","commandType":"auto","position":8.0,"command":"%md-sandbox\n&copy; 2020 Databricks, Inc. All rights reserved.<br/>\nApache, Apache Spark, Spark and the Spark logo are trademarks of the <a href=\"http://www.apache.org/\">Apache Software Foundation</a>.<br/>\n<br/>\n<a href=\"https://databricks.com/privacy-policy\">Privacy Policy</a> | <a href=\"https://databricks.com/terms-of-use\">Terms of Use</a> | <a href=\"http://help.databricks.com/\">Support</a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"45ca2d19-7a7a-4b0b-b081-7fdbc5db0e93"}],"dashboards":[],"guid":"39b2ed3a-12c4-455e-9ab5-cf1647fbc6b2","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{}}