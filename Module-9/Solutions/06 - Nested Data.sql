{"version":"NotebookV1","origId":3623476344927692,"name":"06 - Nested Data","language":"sql","commands":[{"version":"CommandV1","origId":3623476344927693,"guid":"159ca7c4-18b0-4d57-86c6-971aec060899","subtype":"command","commandType":"auto","position":1.0,"command":"\n%md-sandbox\n\n<div style=\"text-align: center; line-height: 0; padding-top: 9px;\">\n  <img src=\"https://databricks.com/wp-content/uploads/2018/03/db-academy-rgb-1200px.png\" alt=\"Databricks Learning\" style=\"width: 600px\">\n</div>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4fbda188-3aa8-4fcd-81e0-e40c77e82f7f"},{"version":"CommandV1","origId":3623476344927694,"guid":"5d24da81-1cc0-4c3b-a49c-aeca4ef56c0f","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n## Create Tables\nRun the cell below to create tables for the questions in this notebook. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d4dcf314-f456-40c9-89eb-82255b4c4488"},{"version":"CommandV1","origId":3623476344927695,"guid":"b94d907a-0c28-4a33-a4df-1c495c7fdaf1","subtype":"command","commandType":"auto","position":3.0,"command":"%run ../Utilities/06-CreateTables","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"545c01dc-dda5-411a-930d-7dbe40dcf62f"},{"version":"CommandV1","origId":3623476344927696,"guid":"90a728af-d2ed-4c35-b4a7-4f4534fab4a3","subtype":"command","commandType":"auto","position":4.0,"command":"%md\n## Question 1: Array and Explode\n### Summary\nGet a distinct list of authors who have contributed blog posts in the \"Company Blog\" category.\n\n### Steps to complete\nWrite a SQL query that achieves the following: \n- Explodes the **`authors`** field to create an **`author`** field that contains only one author per row in table **`databricksBlog`**.\n- Limits records to contain **only** unique authors\n- Filters records where **`categories`** include \"Company Blog\"\n- Store the results in a temporary view named  **`results`**\n\nA properly completed solution should produce a view named **`results`** similar to this sample output:\n\n|              author|        categories|\n|--------------------|----------------|\n|Anthony Joseph      |[\"Announcements\", \"Company Blog\"]| \n|Vida Ha        |[\"Company Blog\", \"Product\"]| \n|Nan Zhu (Chief Architect at Faimdata)    |[\"Company Blog\", \"Product\"]| ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"12cefc39-cfbc-4ed1-83b5-040a82ea2c1a"},{"version":"CommandV1","origId":3623476344927697,"guid":"a8e9ebee-62d0-4973-9e89-57a224ccfb7f","subtype":"command","commandType":"auto","position":5.0,"command":"--ANSWER\nCREATE OR REPLACE TEMPORARY VIEW results AS\n  SELECT \n   DISTINCT (EXPLODE(authors)) AS author,\n   categories\n  FROM databricksBlog\n  WHERE array_contains(categories, \"Company Blog\");\n  \nSELECT * FROM results;\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2bfdd295-2a07-4fc4-94b1-37f80fac2cbb"},{"version":"CommandV1","origId":3623476344927698,"guid":"69696614-9e8d-412d-bc58-adb454b5ee5f","subtype":"command","commandType":"auto","position":6.0,"command":"%md-sandbox\n&copy; 2020 Databricks, Inc. All rights reserved.<br/>\nApache, Apache Spark, Spark and the Spark logo are trademarks of the <a href=\"http://www.apache.org/\">Apache Software Foundation</a>.<br/>\n<br/>\n<a href=\"https://databricks.com/privacy-policy\">Privacy Policy</a> | <a href=\"https://databricks.com/terms-of-use\">Terms of Use</a> | <a href=\"http://help.databricks.com/\">Support</a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"191e4a82-dd6d-45c7-b03c-cfb9cfc44d24"}],"dashboards":[],"guid":"fbfbc745-906b-4e59-809a-c46fd337f34e","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{}}