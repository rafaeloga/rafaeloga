{"version":"NotebookV1","origId":3623476344927672,"name":"03 - Joins","language":"sql","commands":[{"version":"CommandV1","origId":3623476344927673,"guid":"216c27ed-e22d-4724-bf0a-985ac333ba88","subtype":"command","commandType":"auto","position":1.0,"command":"\n%md-sandbox\n\n<div style=\"text-align: center; line-height: 0; padding-top: 9px;\">\n  <img src=\"https://databricks.com/wp-content/uploads/2018/03/db-academy-rgb-1200px.png\" alt=\"Databricks Learning\" style=\"width: 600px\">\n</div>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5d77ce7b-ae8b-40eb-a229-d199d6b3ad17"},{"version":"CommandV1","origId":3623476344927674,"guid":"296c33cc-5054-4346-86a7-c5dee718ad4b","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n## Create Tables\nRun the cell below to create tables for the questions in this notebook. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e31c2dd2-9077-4893-b2c2-e734f3aac59b"},{"version":"CommandV1","origId":3623476344927675,"guid":"6fbd620c-b719-4f9e-88b5-163a6798cea3","subtype":"command","commandType":"auto","position":3.0,"command":"%run ../Utilities/03-CreateTables","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"363781c4-cf3f-4894-b437-82dced588cc1"},{"version":"CommandV1","origId":3623476344927676,"guid":"c31fc8df-49d2-4b9a-ae73-81b7974e3b3f","subtype":"command","commandType":"auto","position":4.0,"command":"%md\n## Question 1: Joins\n### Summary \nPerform a join of two tables **`purchases`** and **`prices`**.\n\n### Steps to complete\nWrite a SQL query that acheives the following: \n* Performs an inner join on two tables **`purchases`** and **`prices`** on the column **`itemId`**\n* Includes **only** 3 columns from the **`purchases`** table: **`transactionId`**, **`itemId`**, and **`value`**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"45203063-abd3-4968-8511-8d0ad72a7190"},{"version":"CommandV1","origId":3623476344927677,"guid":"951ba9b6-caf0-477f-827b-f8cac3b15c55","subtype":"command","commandType":"auto","position":5.0,"command":"--ANSWER\nSELECT transactionId, itemName, purchases.itemId, value FROM purchases\nJOIN prices ON purchases.itemId = prices.itemId;","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"84c8209b-d880-443c-9716-22b415739bb6"},{"version":"CommandV1","origId":3623476344927678,"guid":"6ba3e539-6b81-43eb-86be-d4c3edaa2a1d","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n## Question 2: Combine Tables\n### Summary\nPerform an outer join on two tables **`discounts`** and **`products`** store the results into **`q2Results`** view.\n\n### Steps to complete\nWrite a SQL query that achieves the following: \n* Performs an outer join on table **`discounts`** and **`products`** on the **`itemName`** column\n* Ensures that the joined view only includes **one** **`itemName`** column that comes from the **`products`** table\n\n\nThe final schema and DataFrame should contain the following columns, though not necessarily in this order:\n\n|column |type |\n|---|---|\n|itemName | string|\n|discountId | integer|\n|discountCode | string|\n|price | double|\n|active | boolean|\n|itemId | integer|\n|amount | integer|","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3a9c1e2f-2df7-459c-8183-01e82e610860"},{"version":"CommandV1","origId":3623476344927679,"guid":"72e65c5f-7f05-452c-8278-c1c966169c34","subtype":"command","commandType":"auto","position":7.0,"command":"--ANSWER\nSELECT * FROM products \nOUTER JOIN discounts\nUSING (itemName);\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6d41c02d-3704-42a8-b605-27d9af0b68c2"},{"version":"CommandV1","origId":3623476344927680,"guid":"aa1bb9da-9dd4-4df6-bbb5-72d84d8220b7","subtype":"command","commandType":"auto","position":8.0,"command":"%md\n## Question 3: Cross Join Tables\n### Summary\nPerform a cross join on two tables **`stores`** and **`articles`**.\n\n### Steps to complete\n\n* Perform a cross join on two tables **`stores`** and **`articles`**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8a5e3f8e-46b4-4895-843d-0a0367d229fd"},{"version":"CommandV1","origId":3623476344927681,"guid":"32206a57-9502-4a62-84c2-f371f4fe3989","subtype":"command","commandType":"auto","position":9.0,"command":"--ANSWER\nSELECT * FROM stores \nCROSS JOIN products;\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"67d52177-0b67-452d-9eaa-dba9d4e8a661"},{"version":"CommandV1","origId":3623476344927682,"guid":"a9a9084d-f0c1-4838-95cd-a48b5c66b91b","subtype":"command","commandType":"auto","position":10.0,"command":"%md-sandbox\n&copy; 2020 Databricks, Inc. All rights reserved.<br/>\nApache, Apache Spark, Spark and the Spark logo are trademarks of the <a href=\"http://www.apache.org/\">Apache Software Foundation</a>.<br/>\n<br/>\n<a href=\"https://databricks.com/privacy-policy\">Privacy Policy</a> | <a href=\"https://databricks.com/terms-of-use\">Terms of Use</a> | <a href=\"http://help.databricks.com/\">Support</a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7721b110-de18-4d20-bbfa-5fba2a37e22e"}],"dashboards":[],"guid":"f623ce8f-7a30-4396-a9bc-71c3e52fa97e","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{}}