{"version":"NotebookV1","origId":3623476344927411,"name":"3.4 Lab: Exploratory Data Analysis","language":"sql","commands":[{"version":"CommandV1","origId":3623476344927412,"guid":"5758d799-170a-42fe-aab8-93bbb9d25fdc","subtype":"command","commandType":"auto","position":1.0,"command":"\n%md-sandbox\n\n<div style=\"text-align: center; line-height: 0; padding-top: 9px;\">\n  <img src=\"https://databricks.com/wp-content/uploads/2018/03/db-academy-rgb-1200px.png\" alt=\"Databricks Learning\" style=\"width: 600px\">\n</div>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"912aa8ad-802b-487f-9192-e077b2324371"},{"version":"CommandV1","origId":3623476344927413,"guid":"8d685092-b902-463b-8fca-ec6a6ee63032","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n# Lab 1 - Exploratory Data Analysis\n## Module 3 Assignment\n\n## ![Spark Logo Tiny](https://files.training.databricks.com/images/105/logo_spark_tiny.png) In this assignment you will: </br>\n\n* Create tables\n* Create temporary views\n* Write basic SQL queries to explore, manipulate, and present data\n* Join two views and visualize the result\n\nAs you work through these exercises, you will be prompted to enter selected answers in Coursera. Find the quiz associated with this lab to enter your answers. \n\nRun the cell below to prepare this workspace for the lab. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"feaf4433-c3fe-47e1-818f-f0345df90d12"},{"version":"CommandV1","origId":3623476344927414,"guid":"7bb256fb-a6a9-4920-9601-3a464780e166","subtype":"command","commandType":"auto","position":3.0,"command":"%run ../Includes/Classroom-Setup","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"87ecd68d-e8e4-46c0-8b2e-12c1f6bad0db"},{"version":"CommandV1","origId":3623476344927415,"guid":"97db95be-d6ca-40e3-8093-f13c778b7728","subtype":"command","commandType":"auto","position":4.0,"command":"%md\n\n## Working with Retail Data\nFor this assignment,\nwe'll be working with a generated dataset meant to mimic data collected for online retail transactions. It was added to your workspace when you ran the previous cell. You can use the following path to access the data: \n`/mnt/training/online_retail/data-001/data.csv`","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"650f6970-b43b-48a8-9e1d-4e29b21a67ca"},{"version":"CommandV1","origId":3623476344927416,"guid":"99ad1dcf-de66-470c-87e1-7bbaecdb7314","subtype":"command","commandType":"auto","position":5.0,"command":"%md\n## Exercise 1:  Create a table\nSummary: Create a new table named `outdoorProducts` with the following schema: \n\n\n|Column Name | Type |\n| ---------- | ---- |\n|invoiceNo   | STRING |\n|stockCode   | STRING |\n|description | STRING |\n|quantity    | INT |\n|invoiceDate | STRING|\n|unitPrice  | DOUBLE | \n|customerID  | INT |\n|countryName | STRING|\n\nSteps to complete: \n* Make sure this notebook is idempotent by dropping any tables that have the name `outdoorProducts`\n* Use `csv` as the specified data source\n* Use the path provided above to access the data\n* This data contains a header; include that in your table creation statement","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6caa6aa2-dfe9-4d70-8e54-6d55542ac9ae"},{"version":"CommandV1","origId":3623476344927417,"guid":"945eaa9f-c330-4cf7-8f8f-a4b324fe8465","subtype":"command","commandType":"auto","position":6.0,"command":"-- ANSWER\nDROP TABLE IF EXISTS outdoorProducts;\nCREATE TABLE outdoorProducts (\n  invoiceNo STRING,\n  stockCode STRING,\n  description STRING,\n  quantity INT,\n  invoiceDate STRING,\n  unitPrice DOUBLE,\n  customerID STRING,\n  countryName STRING\n) USING csv OPTIONS (\n  path \"/mnt/training/online_retail/data-001/data.csv\",\n  header \"true\"\n);","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"290f4761-4e53-4f10-91ed-3f9fb605d362"},{"version":"CommandV1","origId":3623476344927418,"guid":"db7fbd86-10e7-4e8a-8679-ab9a8290a0fb","subtype":"command","commandType":"auto","position":7.0,"command":"%md\n\n## Exercise 2: Explore the data\n\n**Summary:** Count the number of items that have a negative `quantity`\n\nThis table keeps track of online transactions, including returns. Some of the quantities in the `quantity` column show a negative number. Run a query that counts then number of negative values in the `quantity` column. \n\nSteps to complete: \n* Write a query that reports the number of values less than 0 in the `quantity` column\n* **Report the answer in the corresponding quiz in Coursera**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9437d9f0-f967-41a4-ad1b-481cc9a82d41"},{"version":"CommandV1","origId":3623476344927419,"guid":"88289884-7a46-4f61-bb14-e1da54ca2da9","subtype":"command","commandType":"auto","position":8.0,"command":"-- ANSWER\nSELECT\n  count(*)\nFROM\n  outdoorProducts\nWHERE\n  quantity < 0;","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b79a3b8c-5e43-4bc3-831b-6e2aab777e50"},{"version":"CommandV1","origId":3623476344927420,"guid":"39a0e5b0-fa44-4fee-bc36-da3fa7c99d49","subtype":"command","commandType":"auto","position":9.0,"command":"%md\n## Exercise 3: Create a temporary view\n\n**Summary:** Create a temporary view that includes only the specified columns and rows, and uses math to create a new column. \n\n**Steps to complete:**\n* Create a temporary view named `sales`\n* Create a new column, `totalAmount`, by multiplying `quantity` times `unitPrice` and rounding to the nearest cent\n* Include columns: `stockCode`, `quantity`, `unitPrice`, `totalAmount`, `countryName`\n* Include only rows where `quantity` is greater than 0","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c701016b-5603-48c6-9339-9b17306eed7b"},{"version":"CommandV1","origId":3623476344927421,"guid":"221ff667-fbc8-461a-b7fe-f609e096ee65","subtype":"command","commandType":"auto","position":10.0,"command":"-- ANSWER\nCREATE\nOR REPLACE TEMPORARY VIEW sales AS\nSELECT\n  stockCode,\n  quantity,\n  unitPrice,\n  ROUND(quantity * unitPrice, 2) AS totalAmount,\n  countryName\nFROM\n  outdoorProducts\nWHERE\n quantity > 0;","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4a80eebb-7bdc-4bad-a186-ce5f65a8e993"},{"version":"CommandV1","origId":3623476344927422,"guid":"badeb533-c7ec-445d-8cd0-14ebbb3f9c1a","subtype":"command","commandType":"auto","position":11.0,"command":"%md\n## Exercise 4: Display ordered view\n\n**Summary:** Show the view you created with `totalAmount` sorted greatest to least\n\n**Steps to complete: **\n* Select all columns form the view `sales`\n* Order the `totalAmount` column from greatest to least\n* **Report the `countryName` from the row with the greatest `totalAmount` of sales in the corresponding answer area in Coursera**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6633d9d5-bbf4-4622-9a8d-93d4c8123e63"},{"version":"CommandV1","origId":3623476344927423,"guid":"be0b70d2-707c-4ffd-891d-41d8e7742161","subtype":"command","commandType":"auto","position":12.0,"command":"-- ANSWER\nSELECT\n  *\nFROM\n  sales\nORDER BY\n  totalAmount DESC;","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a519f92d-4a2c-4827-a0c0-23fef30cc252"},{"version":"CommandV1","origId":3623476344927424,"guid":"22518e4c-b743-4c42-b6ef-42b2b292b9a3","subtype":"command","commandType":"auto","position":13.0,"command":"%md\n## Exercise 5: View countries\n**Summary:** Show a list of all unique `countryName` values in the `sales` view\n\n**Steps to complete:**\n* Write a query that returns only distinct `countryName` values\n* **Answer the corresponding question in Coursera**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"743782b3-82b0-4635-adb7-3b1a2dea64c7"},{"version":"CommandV1","origId":3623476344927425,"guid":"30125333-38df-4ffe-83ef-db021346514c","subtype":"command","commandType":"auto","position":14.0,"command":"-- ANSWER\nSELECT\n  DISTINCT(countryName)\nFROM\n  sales","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4de3f35c-9291-4410-a5e2-60b00093274a"},{"version":"CommandV1","origId":3623476344927426,"guid":"33584037-67a0-4840-9bf8-c799d4e093a0","subtype":"command","commandType":"auto","position":15.0,"command":"%md\n## Exercise 6: Create a temporary view: `salesQuants`\n**Summary:** Create a temporary view that shows total `quantity` of items purchased from each `countryName`\n\n**Steps to complete:** \n* Create a temporary view named `salesQuants`\n* Display the sum of all `quantity` values grouped by `countryName`. Name that column `totalQuantity`\n* Order the view by `totalQuantity` from greatest to least\n* **Answer the corresponding question in Coursera** ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"57162490-e94f-442b-8a6f-3e811cf3e722"},{"version":"CommandV1","origId":3623476344927427,"guid":"2763b599-1835-471b-9a51-cd0fcf222159","subtype":"command","commandType":"auto","position":16.0,"command":"-- ANSWER\nCREATE\nOR REPLACE TEMP VIEW salesQuants AS\nSELECT\n  SUM(quantity) AS totalQuantity,\n  countryName\nFROM\n  sales\nGROUP BY\n  countryName\nORDER BY\n  totalQuantity DESC;\n\nSELECT * FROM salesQuants;","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"64af6ade-42e3-4355-982c-0a2504c8af54"},{"version":"CommandV1","origId":3623476344927428,"guid":"9c7fe959-2c49-485d-9de7-06db0421987a","subtype":"command","commandType":"auto","position":17.0,"command":"%md\n## Exercise 7: Read in a new parquet table\n**Summary:** Create a new table named `countryCodes`.\n\n**Steps to complete:** \n* Drop any existing tables named `countryCodes` from your database\n* Use this path: `/mnt/training/countries/ISOCountryCodes/ISOCountryLookup.parquet` to create a new table using parquet as the data source. Name it `countryCodes`\n* Include options to indicate that there **is** a header for this table","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"05098830-d42b-452c-9b96-08f121c8be25"},{"version":"CommandV1","origId":3623476344927429,"guid":"8ace9acd-d498-4bbe-a920-02ab44434558","subtype":"command","commandType":"auto","position":18.0,"command":"-- ANSWER\n\nDROP TABLE IF EXISTS countryCodes;\nCREATE TABLE countryCodes USING parquet OPTIONS (\n  path \"/mnt/training/countries/ISOCountryCodes/ISOCountryLookup.parquet\",\n  header \"true\"\n);","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6ca68e69-4f71-4c18-baf0-859d2c8fad20"},{"version":"CommandV1","origId":3623476344927430,"guid":"44861033-6fd2-4f7b-9463-bbc6061a35bf","subtype":"command","commandType":"auto","position":19.0,"command":"%md\n## Exercise 8: View metadata\n**Summary:** View column names and data types in this table.\n\n**Steps to complete:**\n* Use the `DESCRIBE` command to display all of column names and their data types\n* **Answer the corresponding question in Coursera** ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4a1d2485-c7a9-40c9-86d7-528a1b1d6194"},{"version":"CommandV1","origId":3623476344927431,"guid":"cad2e326-e42a-48c0-9a56-f1be12a2dde3","subtype":"command","commandType":"auto","position":20.0,"command":"-- ANSWER \nDESCRIBE countryCodes;","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cd7652bc-21f2-4b53-aae7-5db32271c55a"},{"version":"CommandV1","origId":3623476344927432,"guid":"010a4d0b-7f5b-4b17-9557-96300275dab3","subtype":"command","commandType":"auto","position":21.0,"command":"%md\n## Exercise 9: Join and Visualize\n\n**Summary:** Use the `salesQuants` view and the `countryCodes` table to display a pie chart that shows total sales by country, and identifies the country by its 3-letter id. \n\n**Steps to complete:** \n* Write a query that results in two columns: `totalQuantity` from `salesQuants` and `alpha3Code` from `countryCodes`\n* Join `countryCodes` with `salesQuants` on the name of country listed in each table\n* Visualize your results as a pie chart that shows the percent of sales from each country","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"65e21c4e-8670-44e7-bc43-b0bbe4ff0186"},{"version":"CommandV1","origId":3623476344927433,"guid":"ef0e69ba-1992-4b60-a9e3-0a0e7aa16b37","subtype":"command","commandType":"auto","position":22.0,"command":"-- ANSWER\nSELECT\n  totalQuantity,\n  countryCodes.alpha3Code AS countryAbbr\nFROM\n  salesQuants\n  JOIN countryCodes ON countryCodes.EnglishShortName = salesQuants.CountryName","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9fdeff26-a357-44a8-8564-d168adb92b32"},{"version":"CommandV1","origId":3623476344927434,"guid":"c0fac177-a6dd-475b-b1de-4a16de64870b","subtype":"command","commandType":"auto","position":23.0,"command":"%md\n## Sanity Check\nIt's always smart to do a sanity check when manipulating and joining datasets.  \n* Compare your chart to the table you displayed in task #4\n* Try the challenge problem to figure out what may have gone wrong","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e24259bf-c262-4c1b-9af6-537eb046ea66"},{"version":"CommandV1","origId":3623476344927435,"guid":"eda4928e-c66c-4f95-8d7a-fb295c0832e7","subtype":"command","commandType":"auto","position":24.0,"command":"%md-sandbox\n## Challenge: Find the problem\n\n<script type=\"text/javascript\">\n  window.onload = function() {\n    var allHints = document.getElementsByClassName(\"hint-9672\");\n    var answer = document.getElementById(\"answer-9672\");\n    var totalHints = allHints.length;\n    var nextHint = 0;\n    var hasAnswer = (answer != null);\n    var items = new Array();\n    var answerLabel = \"Click here for the answer\";\n    for (var i = 0; i < totalHints; i++) {\n      var elem = allHints[i];\n      var label = \"\";\n      if ((i + 1) == totalHints)\n        label = answerLabel;\n      else\n        label = \"Click here for the next hint\";\n      items.push({label: label, elem: elem});\n    }\n    if (hasAnswer) {\n      items.push({label: '', elem: answer});\n    }\n\n    var button = document.getElementById(\"hint-button-9672\");\n    if (totalHints == 0) {\n      button.innerHTML = answerLabel;\n    }\n    button.onclick = function() {\n      items[nextHint].elem.style.display = 'block';\n      if ((nextHint + 1) >= items.length)\n        button.style.display = 'none';\n      else\n        button.innerHTML = items[nextHint].label;\n        nextHint += 1;\n    };\n    button.ondblclick = function(e) {\n      e.stopPropagation();\n    }\n    var answerCodeBlocks = document.getElementsByTagName(\"code\");\n    for (var i = 0; i < answerCodeBlocks.length; i++) {\n      var elem = answerCodeBlocks[i];\n      var parent = elem.parentNode;\n      if (parent.name != \"pre\") {\n        var newNode = document.createElement(\"pre\");\n        newNode.append(elem.cloneNode(true));\n        elem.replaceWith(newNode);\n        elem = newNode;\n      }\n      elem.ondblclick = function(e) {\n        e.stopPropagation();\n      };\n\n      elem.style.marginTop = \"1em\";\n    }\n  };\n</script>\n\n<div>\n  <button type=\"button\" class=\"btn btn-light\"\n          style=\"margin-top: 1em\"\n          id=\"hint-button-9672\">Click here for a hint</button>\n</div>\n<div class=\"hint-9672\" style=\"padding-bottom: 20px; display: none\">\n  Hint:\n  <div style=\"margin-left: 1em\">Display a distinct list of all countries in the countryCodes table. Compare that list with the distinct list of countries from the outdoorProducts chart.</div>\n</div>\n\n\n<div class=\"hint-9672\" style=\"padding-bottom: 20px; display: none\">\n  Hint:\n  <div style=\"margin-left: 1em\">Use the `REPLACE()` command to make `United Kingdom` labels identical in for both datasets</div>\n</div>\n\n\n<div class=\"hint-9672\" style=\"padding-bottom: 20px; display: none\">\n  Hint:\n  <div style=\"margin-left: 1em\">Rejoin and visualize the two datasets to show which countries sales are coming from</div>\n</div>\n\n\n<div id=\"answer-9672\" style=\"padding-bottom: 20px; display: none\">\n  The answer:\n  <div class=\"answer\" style=\"margin-left: 1em\">\nCheck the solution set at the end of this module for one possible answer.\n  </div>\n</div>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"91f8342a-0c94-463b-b6bf-e9558869bc92"},{"version":"CommandV1","origId":3623476344927436,"guid":"713eef76-5463-4405-93db-a84a6247b63e","subtype":"command","commandType":"auto","position":25.0,"command":"-- ANSWER\nSELECT DISTINCT(EnglishShortName) FROM countryCodes ORDER BY EnglishShortName DESC;","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"539e0c8d-518c-4aee-8e30-916cb4057cbd"},{"version":"CommandV1","origId":3623476344927437,"guid":"6d5bd3c2-3bac-4b20-9792-3c384818eefc","subtype":"command","commandType":"auto","position":26.0,"command":"CREATE\nOR REPLACE TEMPORARY VIEW modCountryCodes AS\nSELECT\n  alpha3code,\n  REPLACE (\n    EnglishShortName,\n    \"United Kingdom of Great Britain and Northern Ireland\",\n    \"United Kingdom\"\n  ) AS EnglishShortName\nFROM\n  countryCodes;","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a5d570a0-9866-47bc-9b47-a42f0ad096c1"},{"version":"CommandV1","origId":3623476344927438,"guid":"deb77716-6a15-456b-acba-b889519d7f29","subtype":"command","commandType":"auto","position":27.0,"command":"-- ANSWER\nSELECT\n  totalQuantity,\n  modCountryCodes.alpha3Code AS countryAbbr\nFROM\n  salesQuants\n  JOIN modCountryCodes ON modCountryCodes.EnglishShortName = salesQuants.CountryName","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b35d3acf-fd3e-4d27-ad3c-3fc16fa74461"},{"version":"CommandV1","origId":3623476344927439,"guid":"2cd5daed-2c0a-4715-a025-35daf467ca1b","subtype":"command","commandType":"auto","position":28.0,"command":"%run ../Includes/Classroom-Cleanup\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7fefef3c-d76c-4bc9-9bec-a92600180aa2"},{"version":"CommandV1","origId":3623476344927440,"guid":"2ad8c35e-96fe-4a16-8fb2-5d12e004a59c","subtype":"command","commandType":"auto","position":29.0,"command":"%md-sandbox\n&copy; 2020 Databricks, Inc. All rights reserved.<br/>\nApache, Apache Spark, Spark and the Spark logo are trademarks of the <a href=\"http://www.apache.org/\">Apache Software Foundation</a>.<br/>\n<br/>\n<a href=\"https://databricks.com/privacy-policy\">Privacy Policy</a> | <a href=\"https://databricks.com/terms-of-use\">Terms of Use</a> | <a href=\"http://help.databricks.com/\">Support</a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f5760aa8-a8c6-48ab-9ffb-d009f3afa063"}],"dashboards":[],"guid":"b287053f-df60-4e77-85a3-5e93d2b65a18","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2}}