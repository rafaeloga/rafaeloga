{"version":"NotebookV1","origId":3623476344927333,"name":"8-2-Setup","language":"sql","commands":[{"version":"CommandV1","origId":3623476344927334,"guid":"47e04ecb-44ce-4249-b118-f2dfac37e6ca","subtype":"command","commandType":"auto","position":1.0,"command":"\n%run \"./Classroom-Setup\"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ed85575a-0dab-432e-9ba1-97f90eefdde8"},{"version":"CommandV1","origId":3623476344927335,"guid":"dd20b774-41ad-4c09-9044-f0378493affa","subtype":"command","commandType":"auto","position":2.0,"command":"%fs rm -r /health_tracker/gold","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"38b91fed-1101-4066-aefe-41996a3c66aa"},{"version":"CommandV1","origId":3623476344927336,"guid":"e7a69f67-c6dc-45df-8c00-3aa217100169","subtype":"command","commandType":"auto","position":3.0,"command":"DROP TABLE IF EXISTS health_tracker_data_2020_01;              \n\nCREATE TABLE health_tracker_data_2020_01                        \nUSING json                                             \nOPTIONS (\n  path \"dbfs:/mnt/training/healthcare/tracker/raw.json/health_tracker_data_2020_1.json\",\n  inferSchema \"true\"\n  );","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"68b6465a-889e-41dc-928f-8de2b51f62c0"},{"version":"CommandV1","origId":3623476344927337,"guid":"2df00765-c31f-4a6c-9177-ce238e530747","subtype":"command","commandType":"auto","position":4.0,"command":"CREATE OR REPLACE TABLE health_tracker_silver \nUSING DELTA\nPARTITIONED BY (p_device_id)\nLOCATION \"/health_tracker/silver\" AS (\nSELECT\n  value.name,\n  value.heartrate,\n  CAST(FROM_UNIXTIME(value.time) AS timestamp) AS time,\n  CAST(FROM_UNIXTIME(value.time) AS DATE) AS dte,\n  value.device_id p_device_id\nFROM\n  health_tracker_data_2020_01\n)\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c2fe4039-12c8-419f-82a4-cc62c96b202c"},{"version":"CommandV1","origId":3623476344927338,"guid":"7bfe9a99-98ae-4716-8f31-de1295d86261","subtype":"command","commandType":"auto","position":5.0,"command":"DROP TABLE IF EXISTS health_tracker_silver;\n\nCREATE TABLE health_tracker_silver\nUSING DELTA\nLOCATION \"/health_tracker/silver\"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2a0c94be-72a0-4d46-b35b-c028e795b9c9"},{"version":"CommandV1","origId":3623476344927339,"guid":"c0dfdc48-519f-46d7-b726-316076f89d4f","subtype":"command","commandType":"auto","position":6.0,"command":"DROP TABLE IF EXISTS health_tracker_data_2020_02;              \n\nCREATE TABLE health_tracker_data_2020_02                        \nUSING json                                             \nOPTIONS (\n  path \"dbfs:/mnt/training/healthcare/tracker/raw.json/health_tracker_data_2020_2.json\",\n  inferSchema \"true\"\n  );","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7db9dfa8-8c87-4ef8-9f13-e439c58e8015"},{"version":"CommandV1","origId":3623476344927340,"guid":"339aa823-f201-4a9d-b92f-180bd69f63e5","subtype":"command","commandType":"auto","position":7.0,"command":"INSERT INTO\n  health_tracker_silver\nSELECT\n  value.name,\n  value.heartrate,\n  CAST(FROM_UNIXTIME(value.time) AS timestamp) AS time,\n  CAST(FROM_UNIXTIME(value.time) AS DATE) AS dte,\n  value.device_id p_device_id\nFROM\n  health_tracker_data_2020_02","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fb48175d-815f-4594-916f-8cc94a109351"},{"version":"CommandV1","origId":3623476344927341,"guid":"c19b8df3-4e4b-4855-9a3a-be19d1811fd1","subtype":"command","commandType":"auto","position":8.0,"command":"CREATE OR REPLACE TEMPORARY VIEW broken_readings\nAS (\n  SELECT COUNT(*) as broken_readings_count, dte FROM health_tracker_silver\n  WHERE heartrate < 0\n  GROUP BY dte\n  ORDER BY dte\n)\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d76665bb-1f7b-4f01-9525-2ae129aff89d"}],"dashboards":[],"guid":"72f8ac47-7b65-430d-894f-43da3be769a8","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{}}