{"version":"NotebookV1","origId":3623476344927330,"name":"6-3-Setup","language":"sql","commands":[{"version":"CommandV1","origId":3623476344927331,"guid":"1e52796f-de23-474f-b40a-e0f7a273c85d","subtype":"command","commandType":"auto","position":1.0,"command":"\n%run \"./Classroom-Setup\"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8b36cc80-37e0-4e3c-a9f1-0aa0cfda717d"},{"version":"CommandV1","origId":3623476344927332,"guid":"0adb709b-f35c-44f0-8fdd-a7418b23fc24","subtype":"command","commandType":"auto","position":2.0,"command":"DROP TABLE IF EXISTS DCDataRaw;\nCREATE TABLE DCDataRaw\nUSING parquet                           \nOPTIONS (\n    PATH \"/mnt/training/iot-devices/data-centers/2019-q2-q3\"\n    );\n    \nCREATE TABLE IF NOT EXISTS DeviceData     \nUSING parquet                               \nWITH ExplodeSource                        \nAS\n  (\n  SELECT \n  dc_id,\n  to_date(date) AS date,\n  EXPLODE (source)\n  FROM DCDataRaw\n  )\nSELECT \n  dc_id,\n  key device_type,                         \n  date,\n  value.description,\n  value.ip,\n  value.temps,\n  value.co2_level co2Level\n  \nFROM ExplodeSource;\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"674599d7-8708-4617-bdd5-a4be63d7f369"}],"dashboards":[],"guid":"1c3b62e0-f6db-4552-a218-8f8823a5ecad","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{}}